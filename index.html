<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <title>3D Hierarchical Model</title>

        <script id="vertex-shader" type="x-shader/x-vertex">
        attribute  vec4 vPosition;
        attribute  vec3 vNormal;
        attribute  vec4 vColor;
        varying vec4 fColor;
        varying vec4 vClr;

        uniform vec4 ambientProduct, diffuseProduct, specularProduct;
        uniform vec4 lightPosition;
        uniform float shininess;
        uniform float Ka, Kd, Ks;

        uniform mat4 modelViewMatrix;
        uniform mat4 projectionMatrix;
        uniform bool flatShading;

        void main() 
        {
            // Adapted from angelChap6/shadedCube.html

            vec3 pos = vec3(modelViewMatrix * vPosition);
            vec3 L = normalize(lightPosition.xyz - pos);
            vec3 E = normalize(-pos);
            vec3 H = normalize(L + E);
            vec3 N = normalize(vec3(modelViewMatrix * vec4(vNormal, 0.0)));

            vec4 ambient = ambientProduct;
            vec4 diffuse = max(dot(L, N), 0.0) * diffuseProduct;
            vec4 specular = pow(max(dot(N, H), 0.0), shininess) * specularProduct;

            if( dot(L, N) < 0.0 ) {
                specular = vec4(0.0, 0.0, 0.0, 1.0);
            }

            fColor = Ka * ambient + Kd * diffuse + Ks * specular;
            // fColor = vColor;
            
            if (flatShading){
                fColor = vColor;
                vClr = fColor;
            }
            gl_Position = projectionMatrix * modelViewMatrix * vPosition;
        } 
        </script>

        <script id="fragment-shader" type="x-shader/x-fragment">

        precision mediump float;

        varying  vec4 fColor;
        varying vec4 vClr;
        uniform bool flatShading;

        void main() 
        { 
            if (flatShading){
                gl_FragColor = vClr;
            } else {
                gl_FragColor = fColor;
            }
        } 
        </script>

        <link rel="stylesheet" href="style.css" />
        <script src="Common/webgl-utils.js"></script>
        <script src="Common/initShaders.js"></script>
        <script src="Common/MV.js"></script>
        <script src="script.js"></script>
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
            crossorigin="anonymous"
        />
    </head>

    <body style="background-color: #fefefe">
        <div
            id="page-container"
            class="container d-flex justify-content-center align-items-start gap-5"
        >
            <div>
                <h3 class="text-center mb-3">3D Hierarchical Model</h3>
                <canvas id="gl-canvas" class="shadow" width="512" height="512">
                    Oops ... your browser doesn't support the HTML5 canvas
                    element
                </canvas>
            </div>

            <div class="attr-container">
                <span>Body:</span>

                <div>
                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label"
                            >Z-axis:</label
                        >
                        <input
                            class="form-range"
                            name="body0"
                            type="range"
                            id="body0"
                            min="0"
                            max="360"
                            step="1"
                            value="0"
                        />
                        <span class="slider-label" id="body0Value">0</span>
                    </div>

                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label"
                            >X-axis:</label
                        >
                        <input
                            class="form-range"
                            name="body1"
                            type="range"
                            id="body1"
                            min="-10"
                            max="10"
                            step="0.5"
                            value="0"
                        />
                        <span class="slider-label" id="body1Value">0</span>
                    </div>

                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label"
                            >Y-axis:</label
                        >
                        <input
                            class="form-range"
                            name="body2"
                            type="range"
                            id="body2"
                            min="-10"
                            max="10"
                            step="0.5"
                            value="0"
                        />
                        <span class="slider-label" id="body2Value">0</span>
                    </div>
                </div>

                <br/>

                <span>Head:</span>

                <div>
                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label"
                            >X-axis:</label
                        >
                        <input
                            class="form-range"
                            name="head0"
                            type="range"
                            id="head0"
                            min="-30"
                            max="30"
                            step="1"
                            value="0"
                        />
                        <span class="slider-label" id="head0Value">0</span>
                    </div>

                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label"
                            >Y-axis:</label
                        >
                        <input
                            class="form-range"
                            name="head1"
                            type="range"
                            id="head1"
                            min="-60"
                            max="60"
                            step="1"
                            value="0"
                        />
                        <span class="slider-label" id="head1Value">0</span>
                    </div>

                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label"
                            >Z-axis:</label
                        >
                        <input
                            class="form-range"
                            name="head2"
                            type="range"
                            id="head2"
                            min="-60"
                            max="60"
                            step="1"
                            value="0"
                        />
                        <span class="slider-label" id="head2Value">0</span>
                    </div>

                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label-lg"
                            >Nose:</label
                        >
                        <input
                            class="form-range"
                            name="nose"
                            type="range"
                            id="nose"
                            min="-0.2"
                            max="0.2"
                            step="0.01"
                            value="0"
                        />
                        <span class="slider-label" id="noseValue">0</span>
                    </div>

                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label-lg"
                            >Left Ear:</label
                        >
                        <input
                            class="form-range"
                            name="earLeft0"
                            type="range"
                            id="earLeft0"
                            min="0"
                            max="30"
                            step="1"
                            value="0"
                        />
                        <span class="slider-label" id="earLeft0Value">0</span>
                    </div>

                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label-lg"
                            >Right Ear:</label
                        >
                        <input
                            class="form-range"
                            name="earRight0"
                            type="range"
                            id="earRight0"
                            min="0"
                            max="30"
                            step="1"
                            value="0"
                        />
                        <span class="slider-label" id="earRight0Value">0</span>
                    </div>
                </div>

                <br/>

                <span>Legs:</span>

                <div>
                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label-xl"
                            >Front Left:</label
                        >
                        <input
                            class="form-range"
                            name="legFrontLeft"
                            type="range"
                            id="legFrontLeft"
                            min="-30"
                            max="30"
                            step="1"
                            value="0"
                        />
                        <span class="slider-label" id="legFrontLeftValue">0</span>
                    </div>
                    
                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label-xl"
                            >Front Right:</label
                        >
                        <input
                            class="form-range"
                            name="legFrontRight"
                            type="range"
                            id="legFrontRight"
                            min="-30"
                            max="30"
                            step="1"
                            value="0"
                        />
                        <span class="slider-label" id="legFrontRightValue">0</span>
                    </div>
                    
                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label-xl"
                            >Back Left:</label
                        >
                        <input
                            class="form-range"
                            name="legBackLeft"
                            type="range"
                            id="legBackLeft"
                            min="-30"
                            max="30"
                            step="1"
                            value="0"
                        />
                        <span class="slider-label" id="legBackLeftValue">0</span>
                    </div>
                    
                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label-xl"
                            >Back Right:</label
                        >
                        <input
                            class="form-range"
                            name="legBackRight"
                            type="range"
                            id="legBackRight"
                            min="-30"
                            max="30"
                            step="1"
                            value="0"
                        />
                        <span class="slider-label" id="legBackRightValue">0</span>
                    </div>
                </div>

                <br />

                <span>Tail:</span>

                <div>
                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label"
                            >Z-axis:</label
                        >
                        <input
                            class="form-range"
                            name="tail0"
                            type="range"
                            id="tail0"
                            min="0"
                            max="180"
                            step="1"
                            value="130"
                        />
                        <span class="slider-label" id="tail0Value">130</span>
                    </div>

                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label"
                            >X-axis:</label
                        >
                        <input
                            class="form-range"
                            name="tail1"
                            type="range"
                            id="tail1"
                            min="-60"
                            max="60"
                            step="1"
                            value="0"
                        />
                        <span class="slider-label" id="tail1Value">0</span>
                    </div>
                </div>

                <br/>

                <span>Camera Orientation:</span>

                <div>
                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label"
                            >Theta:</label
                        >
                        <input
                            class="form-range"
                            name="theta"
                            type="range"
                            id="theta"
                            min="-180"
                            max="180"
                            step="1"
                            value="130"
                        />
                        <span class="slider-label" id="thetaValue">130</span>
                    </div>

                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label"
                            >Phi:</label
                        >
                        <input
                            class="form-range"
                            name="phi"
                            type="range"
                            id="phi"
                            min="-180"
                            max="180"
                            step="1"
                            value="0"
                        />
                        <span class="slider-label" id="phiValue">0</span>
                    </div>
                    
                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label"
                            >Radius:</label
                        >
                        <input
                            class="form-range"
                            name="radius"
                            type="range"
                            id="radius"
                            min="0"
                            max="60"
                            step="0.1"
                            value="20"
                        />
                        <span class="slider-label" id="radiusValue">20</span>
                    </div>
                    
                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label"
                            >FOV:</label
                        >
                        <input
                            class="form-range"
                            name="fov"
                            type="range"
                            id="fov"
                            min="10"
                            max="120"
                            step="1"
                            value="50"
                        />
                        <span class="slider-label" id="fovValue">120</span>
                    </div>

                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label"
                            >Near:</label
                        >
                        <input
                            class="form-range"
                            name="near"
                            type="range"
                            id="near"
                            min="0.1"
                            max="5"
                            step="0.1"
                            value="0.1"
                        />
                        <span class="slider-label" id="nearValue">0.1</span>
                    </div>

                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label"
                            >Far:</label
                        >
                        <input
                            class="form-range"
                            name="far"
                            type="range"
                            id="far"
                            min="0"
                            max="5"
                            step="1"
                            value="3"
                        />
                        <span class="slider-label" id="farValue">3</span>
                    </div>
                </div>

                <div class="item btn-container text-center mt-3" id="button">
                    <button
                        class="btn btn-primary me-1"
                        id="smooth-flat"
                        type="button"
                    >
                        Change to Flat Shading
                    </button>
                </div>

                <!-- TODO: Add new attributes below -->


            </div>

            <div class="attr-container">
                <span><b>Material:</b></span>
                <div class="slidecontainer" id="slidecontainer_1">
                    <label for="shininess"
                        >Shininesss:
                        <span id="shininessValue">100</span></label
                    >
                    <input
                        class="form-range"
                        id="shininess"
                        type="range"
                        min="1"
                        max="100"
                        value="100"
                        step="1"
                        class="slider"
                    />
                </div>

                <div class="d-flex gap-3 justify-content-center">
                    <div>
                        <div class="color-container">
                            <input type="color" id="ambient-material" value="#32798B" />
                        </div>
                        <label class="fs-7 opacity-75" for="ambient-material"
                            >Ambient</label
                        >
                    </div>

                    <div>
                        <div class="color-container">
                            <input type="color" id="diffuse-material" value="#6EAA78" />
                        </div>
                        <label class="fs-7 opacity-75" for="diffuse-material"
                            >Diffuse</label
                        >
                    </div>

                    <div>
                        <div class="color-container">
                            <input type="color" id="specular-material" value="#FFFFFF" />
                        </div>
                        <label class="fs-7 opacity-75" for="specular-material"
                            >Specular</label
                        >
                    </div>
                </div>

                <br />

                <span><b>Material Coefficient:</b></span>

                <div>
                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label"
                            >Ambient:</label
                        >
                        <input
                            class="form-range"
                            name="ambient-coefficient"
                            type="range"
                            id="ambient-coefficient"
                            min="0"
                            max="1"
                            step="0.01"
                            value="1"
                        />
                        <span class="slider-label" id="ambient-coefficient-value">1</span>
                    </div>

                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label"
                            >Diffuse:</label
                        >
                        <input
                            class="form-range"
                            name="diffuse-coefficient"
                            type="range"
                            id="diffuse-coefficient"    
                            min="0"
                            max="1"
                            step="0.01"
                            value="1"
                        />
                        <span class="slider-label" id="diffuse-coefficient-value">1</span>
                    </div>

                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label"
                            >Specular:</label
                        >
                        <input
                            class="form-range"
                            name="specular-coefficient"
                            type="range"
                            id="specular-coefficient"    
                            min="0"
                            max="1"
                            step="0.01"
                            value="1"
                        />
                        <span class="slider-label" id="specular-coefficient-value">1</span>
                    </div>

                    <br />
                <!-- TODO: Add new attributes above -->
                <!-- Below is for reference -->

                <div class="slidecontainer" id="slidecontainer_1">
                    <label for="subdivision"
                        >Number of Subdivisions:
                        <span id="subdivisionValue">3</span></label
                    >
                    <input
                        class="form-range"
                        id="slider0"
                        type="range"
                        min="0"
                        max="360"
                        value="1"
                        step="1"
                        class="slider"
                    />
                </div>

                <div class="slidecontainer" id="slidecontainer_2">
                    <label for="scale"
                        >Initial Scale: <span id="scaleValue">1</span>x</label
                    >
                    <input
                        class="form-range"
                        id="scale"
                        type="range"
                        min="0.25"
                        max="2"
                        value="1"
                        step="0.05"
                        class="slider"
                    />
                </div>

                <div class="slidecontainer" id="slidecontainer_3">
                    <label for="speed"
                        >Animation Speed: <span id="speedValue">1x</span></label
                    >
                    <input
                        class="form-range"
                        id="speed"
                        type="range"
                        min="0.25"
                        max="3"
                        value="1"
                        step="0.25"
                        class="slider"
                    />
                </div>

                <span>Rotation Axis</span>
                <div>
                    <div class="form-check form-check-inline">
                        <input
                            class="form-check-input"
                            type="radio"
                            name="rotationAxis"
                            id="rotateX"
                            value="option1"
                        />
                        <label class="form-check-label" for="rotateX"
                            >x-axis</label
                        >
                    </div>
                    <div class="form-check form-check-inline">
                        <input
                            class="form-check-input"
                            type="radio"
                            name="rotationAxis"
                            id="rotateY"
                            value="option2"
                        />
                        <label class="form-check-label" for="rotateY"
                            >y-axis</label
                        >
                    </div>
                    <div class="form-check form-check-inline">
                        <input
                            class="form-check-input"
                            type="radio"
                            name="rotationAxis"
                            id="rotateZ"
                            value="option3"
                            checked
                        />
                        <label class="form-check-label" for="rotateZ"
                            >z-axis</label
                        >
                    </div>
                </div>

                <hr />

                <div
                    class="d-flex justify-content-center align-items-center gap-3 mb-3"
                >
                    <label for="bgColor" class="opacity-75 fs-7"
                        >Background Color</label
                    >
                    <div class="color-container">
                        <input type="color" id="bgColor" value="#ffffff" />
                    </div>
                </div>

                <!-- Colour picker for 4 faces-->
                <div class="d-flex gap-3 justify-content-center">
                    <div>
                        <div class="color-container">
                            <input type="color" id="color1" value="#fdd413" />
                        </div>
                        <label class="fs-7 opacity-75" for="color1"
                            >Face 1</label
                        >
                    </div>

                    <div>
                        <div class="color-container">
                            <input type="color" id="color2" value="#216a8d" />
                        </div>
                        <label class="fs-7 opacity-75" for="color2"
                            >Face 2</label
                        >
                    </div>

                    <div>
                        <div class="color-container">
                            <input type="color" id="color3" value="#1cafec" />
                        </div>
                        <label class="fs-7 opacity-75" for="color3"
                            >Face 3</label
                        >
                    </div>

                    <div>
                        <div class="color-container">
                            <input type="color" id="color4" value="#f6a716" />
                        </div>
                        <label class="fs-7 opacity-75" for="color4"
                            >Face 4</label
                        >
                    </div>
                </div>

                <br />

                <span>Opacity of each faces:</span>

                <div>
                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label"
                            >Face 1:</label
                        >
                        <input
                            class="form-range"
                            name="intensity1"
                            type="range"
                            id="intensity1"
                            min="0"
                            max="1"
                            step="0.01"
                            value="1"
                        />
                    </div>

                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label"
                            >Face 2:</label
                        >
                        <input
                            class="form-range"
                            name="intensity2"
                            type="range"
                            id="intensity2"
                            min="0"
                            max="1"
                            step="0.01"
                            value="1"
                        />
                    </div>

                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label"
                            >Face 3:</label
                        >
                        <input
                            class="form-range"
                            name="intensity3"
                            type="range"
                            id="intensity3"
                            min="0"
                            max="1"
                            step="0.01"
                            value="1"
                        />
                    </div>

                    <div class="d-flex gap-3">
                        <label class="fs-7 opacity-75 text-nowrap w-label"
                            >Face 4:</label
                        >
                        <input
                            class="form-range"
                            name="intensity4"
                            type="range"
                            id="intensity4"
                            min="0"
                            max="1"
                            step="0.01"
                            value="1"
                        />
                    </div>
                </div>

                <hr />

                <div class="item btn-container text-center mt-3" id="button">
                    <button
                        class="btn btn-primary me-1"
                        id="start-stop"
                        type="button"
                    >
                        Start
                    </button>
                    <button
                        class="btn btn-secondary ms-1"
                        id="reset"
                        type="button"
                    >
                        Reset
                    </button>
                    <br />
                    <button
                        class="btn btn-outline-danger mt-1"
                        id="reset-attr"
                        type="button"
                    >
                        Reset All
                    </button>
                </div>
            </div>
        </div>
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
            crossorigin="anonymous"
        ></script>
    </body>
</html>
